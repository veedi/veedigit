Imports System

'------------------------------------------------------------------------------
'<auto-generated>
'    This code was generated by a tool.
'    Runtime Version: 10.0.0.0
' 
'    Changes to this file may cause incorrect behavior and will be lost if
'    the code is regenerated.
'</auto-generated>
'------------------------------------------------------------------------------
Namespace My.Templates
    <System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "10.0.0.0")>  _
    Partial Public Class TransactionControllerGenerator
        Inherits TransactionControllerGeneratorBase
        Public Overridable Function TransformText() As String
            Me.Write("'<auto generated>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"'This code was designed by Transaction framework team for tran"& _ 
                    "saction UI controller"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"'Generated @ ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",4)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(DateTime.Now()))
            
            #End ExternalSource
            Me.Write(" "&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"'User Name :")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",5)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(UserName))
            
            #End ExternalSource
            Me.Write(""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"'Workstation :")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",6)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(WorkstationName))
            
            #End ExternalSource
            Me.Write(""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"'Modifications to the file may cause deviations to actual transaction framework"& _ 
                    " behavior, also code may be lost if regenerated"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"'</auto generated>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports Sys"& _ 
                    "tem.Collections.ObjectModel"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports System.ServiceModel"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports HP.Comet.Prese"& _ 
                    "ntation.Common"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports HP.Comet.Presentation.Common.Data.Contracts"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports HP."& _ 
                    "Comet.Presentation.Common.View.Model"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports HP.Comet.Presentation.Customer.Dat"& _ 
                    "a.Contracts"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports HP.Comet.Presentation.Customer.Services.Proxies"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports HP"& _ 
                    ".Comet.Presentation.Customer.View.Model"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports HP.Comet.Presentation.Driver.Cr"& _ 
                    "edential.Services.Proxies"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"Imports HP.Comet.Presentation.Driver.Data.Contracts"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    ""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&" Public Class ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",20)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("Controller"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Inherits TransactionDetailController(Of ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",21)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write(")"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(9))
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",22)
If WorkflowEnabled Then
            
            #End ExternalSource
            Me.Write(""&Global.Microsoft.VisualBasic.ChrW(9)&"Implements IProcessWorkflowController"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(9))
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",24)
End If
            
            #End ExternalSource
            Me.Write(" "&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Initialize New Learner Permit transaction data."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Public Sub New()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        '"& _ 
                    "Initialize or get transaction data."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        TransactionData = New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",32)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write(""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        TransactionData.TransactionContextDetail = New TransactionContextDetail"& _ 
                    ""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        TransactionData.TransactionContextDetail.Transaction = New Transaction"& _ 
                    ""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        TransactionData.TransactionContextDetail.TransactionType = New Transac"& _ 
                    "tionType() With {"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                                    .Transact"& _ 
                    "ionTypeId = CShort(TransactionTypeCode.")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",36)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("),"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                                    .Description = """)
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",37)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write(""""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                                 }"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <su"& _ 
                    "mmary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Check whether the customer is eligible to initiate the requested"& _ 
                    " transaction or not."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>True if eligible</ret"& _ 
                    "urns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function IsCustomerE"& _ 
                    "ligibleForTransaction() As Boolean"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim result As CustomerEligibilityCol"& _ 
                    "lection = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim isEligibleForTransaction As Boolean = True"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"   "& _ 
                    "     Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            IsCustomerEligibleForTransactionCore(result)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            "& _ 
                    "If result IsNot Nothing AndAlso result.Count > 0 Then"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                For Each "& _ 
                    "eligibility In result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    If (Not (eligibility.IsEligible)) The"& _ 
                    "n"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                        isEligibleForTransaction = eligibility.IsEligible"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"  "& _ 
                    "                      UIHelper.ShowMessageBox(eligibility.Description, My.Resour"& _ 
                    "ces.ApplicationName,"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                                Presentati"& _ 
                    "on.Common.ButtonStyle.OkOnly, ImageDisplay.Critical)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                        Ex"& _ 
                    "it Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    End If"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                Next"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End If"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",63)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",63)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                With TransactionData.TransactionContextDetail"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    "& _ 
                    "                result = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",65)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    IsCustomerEligibleForTransaction(Provisioning.Instan"& _ 
                    "ce.CustomerService.TransactionCustomer.CustomerId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                End With"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"  "& _ 
                    "          End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            If (result IsNot Nothing AndAlso result.Count"& _ 
                    " > 0) Then"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                For Each eligibility In result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    "& _ 
                    "If (Not (eligibility.IsEligible)) Then"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                        isEligibleForTra"& _ 
                    "nsaction = eligibility.IsEligible"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                        UIHelper.ShowMessageB"& _ 
                    "ox(eligibility.Description, My.Resources.ApplicationName,"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                     "& _ 
                    "                           Presentation.Common.ButtonStyle.OkOnly, ImageDisplay."& _ 
                    "Critical, 10, 90)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                        Exit For"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    ElseIf "& _ 
                    "eligibility.IsEligible Then"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                        Dim isEligible As System.Wi"& _ 
                    "ndows.Forms.DialogResult"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                        isEligible = UIHelper.ShowMess"& _ 
                    "ageBox(eligibility.Description, My.Resources.ApplicationName,"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                 "& _ 
                    "                               Presentation.Common.ButtonStyle.YesNo, ImageDispl"& _ 
                    "ay.Question)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                        If isEligible = System.Windows.Forms.Dialo"& _ 
                    "gResult.Yes Then"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                            isEligibleForTransaction = True"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&" "& _ 
                    "                       ElseIf isEligible = System.Windows.Forms.DialogResult.No "& _ 
                    "Then"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                            isEligibleForTransaction = False"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            "& _ 
                    "            End If"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    End If"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                Next"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"          "& _ 
                    "  End If"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Con"& _ 
                    "tracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.D"& _ 
                    "etail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.Messa"& _ 
                    "geDetail, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "       ExceptionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePoli"& _ 
                    "cy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return isEligibleForTransaction"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Functio"& _ 
                    "n"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Partial Private Sub IsCustomerEligibleForTransactionCore(ByRef result A"& _ 
                    "s CustomerEligibilityCollection)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' In"& _ 
                    "itialize the transaction. Set show prerequisite information etc."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summ"& _ 
                    "ary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Sub InitializeTransac"& _ 
                    "tion()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            'Set user controls for prerequisite form"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "       ShowPrequisiteFormCore()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet."& _ 
                    "Presentation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException"& _ 
                    "(ex.Message, ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                "& _ 
                    "      ex.Detail.MessageDetail, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As L"& _ 
                    "oggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor.ProcessUnhandledException(ex, Pol"& _ 
                    "icyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Partial Private Su"& _ 
                    "b ShowPrequisiteFormCore()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Fetch fi"& _ 
                    "rst workflow step details"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' And bind the data with the current transactio"& _ 
                    "n data"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides"& _ 
                    " Function GetCurrentWorkflowStep() As TransactionWorkflowSummary"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim cu"& _ 
                    "rrentWorkflowStep As TransactionWorkflowSummary = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"      "& _ 
                    "      Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",133)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",133)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                currentWorkflowStep = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",134)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GetCurrentWorkflowStep()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As Fault"& _ 
                    "Exception(Of HP.Comet.Presentation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Thr"& _ 
                    "ow New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"          "& _ 
                    "                            ex.Detail.MessageDetail, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor.ProcessUnha"& _ 
                    "ndledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Retur"& _ 
                    "n currentWorkflowStep"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Method to "& _ 
                    "retrieve the mandatory documents for prerequisite document."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetMandatoryDocum"& _ 
                    "ents() As TransactionDocumentSummaryCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim mandatoryDocuments A"& _ 
                    "s TransactionDocumentSummaryCollection = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Usi"& _ 
                    "ng ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",154)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",154)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                With TransactionData.TransactionContextDetail"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    "& _ 
                    "                mandatoryDocuments = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",156)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GetMandatoryDocuments()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                End With"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.Servi"& _ 
                    "ceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorC"& _ 
                    "ode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex"& _ 
                    ".Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Excep"& _ 
                    "tionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"       "& _ 
                    " End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return mandatoryDocuments"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summ"& _ 
                    "ary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Create unique identifier for each transaction."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"& _ 
                    ""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function CreateTransactio"& _ 
                    "n() As Integer"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim transactionId As Integer"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"           "& _ 
                    " Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",177)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",177)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                transactionId = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",178)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                CreateTransaction(Provisioning.Instance.CustomerService."& _ 
                    "TransactionCustomer.CustomerId,"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                  Provisioning."& _ 
                    "Instance.TransactionCart.TransactionCartId,"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                  T"& _ 
                    "ransactionData.TransactionContextDetail. _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                  Tr"& _ 
                    "ansactionWorkflowSummary.TransactionStep.TransactionStepId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Usi"& _ 
                    "ng"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.S"& _ 
                    "erviceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.Er"& _ 
                    "rorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail"& _ 
                    ", ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            E"& _ 
                    "xceptionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"   "& _ 
                    "     End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return transactionId"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summa"& _ 
                    "ry>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Method to set the transaction owner information."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary"& _ 
                    ">"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Sub SetTransactionCustom"& _ 
                    "erInformation()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim transactionContextCustomerViewModel As TransactionC"& _ 
                    "ontextCustomerViewModel"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            'Call the Customer Service t"& _ 
                    "o get the customer Information"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Dim customerId As Integer = Provisio"& _ 
                    "ning.Instance.CustomerService.TransactionCustomer.CustomerId"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            If ("& _ 
                    "Provisioning.Instance.CustomerService.TransactionCustomer.CustomerType ="&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"      "& _ 
                    "          HP.Comet.Presentation.Customer.CustomerType.Individual) Then"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        "& _ 
                    "        Dim individualCustomer As Individual"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                Using customerCl"& _ 
                    "ient As CustomerServiceProxy = New CustomerServiceProxy()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    i"& _ 
                    "ndividualCustomer = customerClient.GetIndividualCustomerDetails(customerId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"   "& _ 
                    "             End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                transactionContextCustomerViewModel = "& _ 
                    "New TransactionContextCustomerViewModel"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                Provisioning.Instance.C"& _ 
                    "ustomerService.TransactionCustomer ="&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    transactionContextCust"& _ 
                    "omerViewModel.GetCustomerTransactionSummary(individualCustomer)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"               "& _ 
                    " SetTransactionCustomerInformationCore(individualCustomer)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Else"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "                Dim businessCustomer As Business"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                Using custom"& _ 
                    "erClient As CustomerServiceProxy = New CustomerServiceProxy()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                 "& _ 
                    "   businessCustomer = customerClient.GetBusinessCustomerDetails(customerId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"   "& _ 
                    "             End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                transactionContextCustomerViewModel = "& _ 
                    "New TransactionContextCustomerViewModel"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                Provisioning.Instance.C"& _ 
                    "ustomerService.TransactionCustomer ="&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    transactionContextCust"& _ 
                    "omerViewModel.GetCustomerTransactionSummary(businessCustomer)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End"& _ 
                    " If"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Provisioning.Instance.CustomerService.TransactionCustomer.Custo"& _ 
                    "merId = customerId"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation."& _ 
                    "Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, "& _ 
                    "ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Deta"& _ 
                    "il.MessageDetail, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedExceptio"& _ 
                    "n"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor.ProcessUnhandledException(ex, PolicyName.Propa"& _ 
                    "gatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(9)&"Partial private sub SetTransaction"& _ 
                    "CustomerInformationCore(ByRef result as Individual)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(9)&"End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summ"& _ 
                    "ary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Get list of user controls for application step required in the tra"& _ 
                    "nsaction."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>List of user controls</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetApplicationTra"& _ 
                    "nsactionSteps(ByVal isSummaryMode As Boolean) As  _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                           "& _ 
                    "                                     Collection(Of CustomUserControl)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        D"& _ 
                    "im result As Collection(Of CustomUserControl) = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        "& _ 
                    "    GetApplicationTransactionStepsCore(isSummaryMode, result)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex "& _ 
                    "As FaultException(Of HP.Comet.Presentation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"       "& _ 
                    "     Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"  "& _ 
                    "                                    ex.Detail.MessageDetail, ex.Detail.Exception"& _ 
                    "Source)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor.Pro"& _ 
                    "cessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "   Return result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Partial Private Sub GetApplicationTran"& _ 
                    "sactionStepsCore(ByVal isSummaryMode As Boolean, ByRef result As Collection(Of C"& _ 
                    "ustomUserControl))"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Validate user in"& _ 
                    "put in application step and reload application step data based on"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' user "& _ 
                    "input for e.g.: Requirements, Restrictions etc."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <pa"& _ 
                    "ram name=""activeApplicationTabPageName"">Current active tab name in application f"& _ 
                    "orm</param>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns></returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Prote"& _ 
                    "cted Overrides Function ValidateApplicationStep(ByVal activeApplicationTabPageNa"& _ 
                    "me As String) As Boolean"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim result As Boolean = False"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "            ValidateApplicationStepCore(activeApplicationTabPageName, result)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&" "& _ 
                    "       Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.Servic"& _ 
                    "eFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCo"& _ 
                    "de, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex."& _ 
                    "Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Except"& _ 
                    "ionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        "& _ 
                    "End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Partial Private Sub Va"& _ 
                    "lidateApplicationStepCore(ByVal activeApplicationTabPageName As String, ByRef re"& _ 
                    "sult As Boolean)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Get interface resu"& _ 
                    "lts which are initiated for the transaction. This method shall implement logic"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "    ''' to fetch interface results."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns></retu"& _ 
                    "rns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetInterface"& _ 
                    "Results() As TransactionInterfaceCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim interfaceResults As Int"& _ 
                    "erfaceResultCollection = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            GetInterfaceResults"& _ 
                    "Core(interfaceResults)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Return interfaceResults.ToDataContractCollec"& _ 
                    "tion"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts"& _ 
                    ".ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail."& _ 
                    "ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDeta"& _ 
                    "il, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"           "& _ 
                    " ExceptionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&" "& _ 
                    "       End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Partial Privat"& _ 
                    "e Sub GetInterfaceResultsCore(ByRef interfaceResults As InterfaceResultCollectio"& _ 
                    "n)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Get applicable document types fo"& _ 
                    "r the transaction based on user data. This method returns list of "&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' all "& _ 
                    "mandatory document types that are required to process the transaction and condit"& _ 
                    "ional document"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' types based on user input data."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"   "& _ 
                    " ''' <returns>List of Mandatory and Conditional document types</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''"& _ 
                    "' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetDocuments() As Transa"& _ 
                    "ctionDocumentSummaryCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim requiredDocuments As TransactionDocu"& _ 
                    "mentSummaryCollection = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",331)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",331)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                requiredDocuments = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",332)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client. _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    GetDocuments(TransactionData.TransactionContextDet"& _ 
                    "ail.Transaction.TransactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As Fault"& _ 
                    "Exception(Of HP.Comet.Presentation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Thr"& _ 
                    "ow New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"          "& _ 
                    "                            ex.Detail.MessageDetail, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor.ProcessUnha"& _ 
                    "ndledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Retur"& _ 
                    "n requiredDocuments"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Get valid do"& _ 
                    "cuments for the document type that are applicable for transaction. This is used "& _ 
                    "to"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' load documents drop down in document step screen."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary"& _ 
                    ">"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>List of applicable documents associated with transaction for"& _ 
                    " the document type</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrid"& _ 
                    "es Function GetDocumentsForDocumentTypes() As TransactionDocumentSummaryCollecti"& _ 
                    "on"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim applicableDocuments As TransactionDocumentSummaryCollection = No"& _ 
                    "thing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",355)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",355)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                applicableDocuments = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",356)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GetTransactionApplicableDocuments()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch "& _ 
                    "ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    "& _ 
                    "        Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex.Detail.Except"& _ 
                    "ionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor."& _ 
                    "ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"  "& _ 
                    "      Return applicableDocuments"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    '''"& _ 
                    " Get applicable deficiencies for the transaction based on user input. This metho"& _ 
                    "d returns list of "&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' deficiencies that are created for the transaction. T"& _ 
                    "his includes interface deficiency, "&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' document deficiency and data defici"& _ 
                    "ency."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>List of deficiencies created</return"& _ 
                    "s>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetDeficiencie"& _ 
                    "s() As TransactionDeficiencySummaryCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim applicableDeficiencie"& _ 
                    "s As TransactionDeficiencySummaryCollection = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"          "& _ 
                    "  Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",379)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",379)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                applicableDeficiencies = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",380)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client. _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                        GetDeficiencies(TransactionDat"& _ 
                    "a.TransactionContextDetail.Transaction.TransactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"  "& _ 
                    "      Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.Service"& _ 
                    "Fault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCod"& _ 
                    "e, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex.D"& _ 
                    "etail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Excepti"& _ 
                    "onProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        E"& _ 
                    "nd Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return applicableDeficiencies"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <su"& _ 
                    "mmary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Get applicable fee types for the transaction based on user input"& _ 
                    "."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>List of fee type</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <rem"& _ 
                    "arks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetApplicableFee() As Transact"& _ 
                    "ionFeeSummaryCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim feeTypes As TransactionFeeSummaryCollection"& _ 
                    " = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",402)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",402)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                feeTypes = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",403)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GetFees(TransactionData.TransactionContextDetail.Transaction.TransactionId"& _ 
                    ")"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Present"& _ 
                    "ation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Mes"& _ 
                    "sage, ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      e"& _ 
                    "x.Detail.MessageDetail, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedEx"& _ 
                    "ception"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor.ProcessUnhandledException(ex, PolicyName"& _ 
                    ".PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return feeTypes"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Save transaction specific i.e user input to stagin"& _ 
                    "g area."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>True on successful save, else fals"& _ 
                    "e</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function SaveD"& _ 
                    "ataToWorkInProgress() As Boolean"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim result As Boolean = False"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "   Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            SaveDataToWorkInProgressCore()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",425)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",425)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",426)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.SaveWorkInProgressTransactionData(Me.TransactionData)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Usi"& _ 
                    "ng"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.S"& _ 
                    "erviceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.Er"& _ 
                    "rorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail"& _ 
                    ", ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            E"& _ 
                    "xceptionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"   "& _ 
                    "     End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Partial Private S"& _ 
                    "ub SaveDataToWorkInProgressCore()"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' T"& _ 
                    "o fetch next workflow approval step for active transaction"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "    ''' <param name=""transactionId"">Holds the transaction Id</param>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <r"& _ 
                    "eturns>current transaction applicable workflow step</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks>"& _ 
                    "</remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetNextWorkflowStep(ByVal transacti"& _ 
                    "onId As Integer) As TransactionWorkflowSummary"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim result As Transactio"& _ 
                    "nWorkflowSummary = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",451)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",451)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                result = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",452)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GetNextWorkflowStep(transactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch e"& _ 
                    "x As FaultException(Of HP.Comet.Presentation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "       Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "                                      ex.Detail.MessageDetail, ex.Detail.Excepti"& _ 
                    "onSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor.P"& _ 
                    "rocessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "   Return result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Generate list o"& _ 
                    "f output document for the transaction."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></r"& _ 
                    "emarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Sub GenerateOutputDocuments(ByVal transactionId"& _ 
                    " As Integer)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",469)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",469)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",470)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GenerateOutputDocument(transactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catc"& _ 
                    "h ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"  "& _ 
                    "          Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, False, "& _ 
                    "_"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex.Detail.Exce"& _ 
                    "ptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcesso"& _ 
                    "r.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "    End Sub"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Complete the transaction. Save all use"& _ 
                    "r input data to main table from the staging"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' area."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "    ''' <param name=""transactionId"">Unique id for the transaction</param>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    '"& _ 
                    "'' <returns>List of error messages, if any</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks"& _ 
                    ">"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function FinalizeTransaction(ByVal transactionId As I"& _ 
                    "nteger, ByVal assignedStaffId As Integer, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                 By"& _ 
                    "Val nextStepId As Integer) As Collection(Of String)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim result As New C"& _ 
                    "ollection(Of String)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",493)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",493)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                result = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",494)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.FinalizeTransactionData(transactionId, assignedStaffId, nextStepId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "       End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Da"& _ 
                    "ta.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex"& _ 
                    ", ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail"& _ 
                    ".MessageDetail, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor.ProcessUnhandledException(ex, PolicyName.Propaga"& _ 
                    "tePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    '''"& _ 
                    " <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Method to update the transaction status in case of Deferred "& _ 
                    "/Cancel"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <param name=""transactionId"">Holds the trans"& _ 
                    "action Id</param>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <param name=""transactionStatusType"">Holds the transac"& _ 
                    "tion type</param>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns></returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"   "& _ 
                    " Protected Overrides Function UpdateTransactionStatus(ByVal transactionId As Int"& _ 
                    "eger, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                                         ByVal transact"& _ 
                    "ionStatusType As Short) As Boolean"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim result As Boolean"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    "            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",517)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",517)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                result = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",518)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.UpdateTransactionStatus(transactionId, transactionStatusType)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"           "& _ 
                    " End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Con"& _ 
                    "tracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.D"& _ 
                    "etail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.Messa"& _ 
                    "geDetail, ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "       ExceptionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePoli"& _ 
                    "cy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summar"& _ 
                    "y>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Get transaction document information processed during the transactio"& _ 
                    "n. This information will be fetched"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' from WIP."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    "& _ 
                    "''' <returns>List of documents processed during the transaction</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    '"& _ 
                    "'' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetDocumentsSummary() A"& _ 
                    "s TransactionDocumentSummaryCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim requiredDocuments As Transac"& _ 
                    "tionDocumentSummaryCollection = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",539)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",539)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                requiredDocuments = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",540)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GetTransactionDocumentsSummary( _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    TransactionData.Tra"& _ 
                    "nsactionContextDetail.Transaction.TransactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"       "& _ 
                    " Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.ServiceFault"& _ 
                    ")"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, Fa"& _ 
                    "lse, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex.Detail"& _ 
                    ".ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionPro"& _ 
                    "cessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Tr"& _ 
                    "y"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return requiredDocuments"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"  "& _ 
                    "  ''' Get applicable deficiencies for the transaction based on user input. This "& _ 
                    "method returns list of "&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' deficiencies that are created for the transacti"& _ 
                    "on. This includes interface deficiency, "&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' document deficiency and data d"& _ 
                    "eficiency."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>List of deficiencies created</r"& _ 
                    "eturns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetDefici"& _ 
                    "enciesSummary() As TransactionDeficiencySummaryCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim applicabl"& _ 
                    "eDeficiencies As TransactionDeficiencySummaryCollection = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"& _ 
                    ""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",564)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",564)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                applicableDeficiencies = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",565)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GetTransactionDeficienciesSummary( _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    TransactionData."& _ 
                    "TransactionContextDetail.Transaction.TransactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    "& _ 
                    "    Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.ServiceFa"& _ 
                    "ult)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCode,"& _ 
                    " False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex.Det"& _ 
                    "ail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Exception"& _ 
                    "Processor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End"& _ 
                    " Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return applicableDeficiencies"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <summ"& _ 
                    "ary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' To fetch the interface summary for a transaction"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summar"& _ 
                    "y>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>List of interface results for the transaction initiated</re"& _ 
                    "turns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Protected Overrides Function GetInterfa"& _ 
                    "ceSummary() As TransactionInterfaceCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim transactionInterfaces"& _ 
                    " As TransactionInterfaceCollection = Nothing"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",587)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",587)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                transactionInterfaces = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",588)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.GetTransactionInterfacesSummary( _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                    TransactionData.Tr"& _ 
                    "ansactionContextDetail.Transaction.TransactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"      "& _ 
                    "  Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.ServiceFaul"& _ 
                    "t)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, F"& _ 
                    "alse, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex.Detai"& _ 
                    "l.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionPr"& _ 
                    "ocessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End T"& _ 
                    "ry"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return transactionInterfaces"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(9))
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",601)
If WorkflowEnabled Then
            
            #End ExternalSource
            Me.Write(""&Global.Microsoft.VisualBasic.ChrW(9)&"''' <summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Check Eligibility for the user to approve the transaction"& _ 
                    " in approval step."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <param name=""transactionId"">Uniq"& _ 
                    "ue identifier for the transaction to approve</param>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>Non Eligi"& _ 
                    "bility summary</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Public Function IsEli"& _ 
                    "gibleToApprove(ByVal transactionId As Integer) As EligibilitySummaryCollection I"& _ 
                    "mplements Common.IProcessWorkflowController.IsEligibleToApprove"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim eli"& _ 
                    "gibilitysToApprove As New EligibilitySummaryCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"         "& _ 
                    "   Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",612)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",612)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                eligibilitysToApprove = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",613)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.IsEligibleToApprove(transactionId:=transactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)& _ 
                    ""&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.Ser"& _ 
                    "viceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.Erro"& _ 
                    "rCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, "& _ 
                    "ex.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Exc"& _ 
                    "eptionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"     "& _ 
                    "   End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return eligibilitysToApprove"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <s"& _ 
                    "ummary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' Assign the transaction to self and approve or move the transact"& _ 
                    "ion to next level of approval."&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' </summary>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <returns>List of err"& _ 
                    "or collection if any</returns>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    ''' <remarks></remarks>"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Public Function"& _ 
                    " FinalizeWorkflowData(ByVal transactionId As Integer) As System.Collections.Obje"& _ 
                    "ctModel.Collection(Of String) Implements Common.IProcessWorkflowController.Final"& _ 
                    "izeWorkflowData"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim result As New Collection(Of String)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",634)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",634)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                result = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",635)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.FinalizeWorkflowData(transactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch "& _ 
                    "ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.ServiceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    "& _ 
                    "        Throw New LoggedException(ex.Message, ex, ex.Detail.ErrorCode, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, ex.Detail.Except"& _ 
                    "ionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            ExceptionProcessor."& _ 
                    "ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"  "& _ 
                    "      Return result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(9)&"Public Function IsEligibleToReject(tra"& _ 
                    "nsactionId As Integer) As Common.Data.Contracts.EligibilitySummaryCollection Imp"& _ 
                    "lements Common.IProcessWorkflowController.IsEligibleToReject"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim eligib"& _ 
                    "ilitysToReject As New EligibilitySummaryCollection"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            U"& _ 
                    "sing ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",651)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",651)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                eligibilitysToReject = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",652)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.IsEligibleToReject(transactionId:=transactionId)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.Serv"& _ 
                    "iceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.Error"& _ 
                    "Code, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, e"& _ 
                    "x.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Exce"& _ 
                    "ptionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"      "& _ 
                    "  End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return eligibilitysToReject"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    Public F"& _ 
                    "unction FinalizeRejectWork(transactionId As Integer, rejectionReason As String) "& _ 
                    "As System.Collections.ObjectModel.Collection(Of String) Implements Common.IProce"& _ 
                    "ssWorkflowController.FinalizeRejectWork"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Dim result As New Collection(Of"& _ 
                    " String)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Using ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",668)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client As New ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",668)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(TransactionName))
            
            #End ExternalSource
            Me.Write("ServiceProxy"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                result = ")
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",669)
            Me.Write(Me.ToStringHelper.ToStringWithCulture(CamelTransactionName))
            
            #End ExternalSource
            Me.Write("Client.FinalizeRejectWork(transactionId, rejectionReason)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            End Using"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As FaultException(Of HP.Comet.Presentation.Data.Contracts.Serv"& _ 
                    "iceFault)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Throw New LoggedException(ex.Message, ex, ex.Detail.Error"& _ 
                    "Code, False, _"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"                                      ex.Detail.MessageDetail, e"& _ 
                    "x.Detail.ExceptionSource)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Catch ex As LoggedException"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"            Exce"& _ 
                    "ptionProcessor.ProcessUnhandledException(ex, PolicyName.PropagatePolicy)"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"      "& _ 
                    "  End Try"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"        Return result"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&"    End Function"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10)&Global.Microsoft.VisualBasic.ChrW(9))
            
            #ExternalSource("C:\Users\veedi\Documents\MyProjects\DMV\RI\T4 Templates\Working Solution\UI Controller Generator\Templates\TransactionControllerGenerator.tt",680)
End If
            
            #End ExternalSource
            Me.Write("End Class"&Global.Microsoft.VisualBasic.ChrW(13)&Global.Microsoft.VisualBasic.ChrW(10))
            Return Me.GenerationEnvironment.ToString
        End Function
    End Class
    #Region "Base class"
    '''<summary>
    '''Base class for this transformation
    '''</summary>
    <System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "10.0.0.0")>  _
    Public Class TransactionControllerGeneratorBase
        #Region "Fields"
        Private generationEnvironmentField As Global.System.Text.StringBuilder
        Private errorsField As Global.System.CodeDom.Compiler.CompilerErrorCollection
        Private indentLengthsField As Global.System.Collections.Generic.List(Of Integer)
        Private currentIndentField As String = ""
        Private endsWithNewline As Boolean
        Private sessionField As Global.System.Collections.Generic.IDictionary(Of String, Object)
        #End Region
        #Region "Properties"
        '''<summary>
        '''The string builder that generation-time code is using to assemble generated output
        '''</summary>
        Protected Property GenerationEnvironment() As System.Text.StringBuilder
            Get
                If (Me.generationEnvironmentField Is Nothing) Then
                    Me.generationEnvironmentField = New Global.System.Text.StringBuilder()
                End If
                Return Me.generationEnvironmentField
            End Get
            Set
                Me.generationEnvironmentField = value
            End Set
        End Property
        '''<summary>
        '''The error collection for the generation process
        '''</summary>
        Public ReadOnly Property Errors() As System.CodeDom.Compiler.CompilerErrorCollection
            Get
                If (Me.errorsField Is Nothing) Then
                    Me.errorsField = New Global.System.CodeDom.Compiler.CompilerErrorCollection()
                End If
                Return Me.errorsField
            End Get
        End Property
        '''<summary>
        '''A list of the lengths of each indent that was added with PushIndent
        '''</summary>
        Private ReadOnly Property indentLengths() As System.Collections.Generic.List(Of Integer)
            Get
                If (Me.indentLengthsField Is Nothing) Then
                    Me.indentLengthsField = New Global.System.Collections.Generic.List(Of Integer)()
                End If
                Return Me.indentLengthsField
            End Get
        End Property
        '''<summary>
        '''Gets the current indent we use when adding lines to the output
        '''</summary>
        Public ReadOnly Property CurrentIndent() As String
            Get
                Return Me.currentIndentField
            End Get
        End Property
        '''<summary>
        '''Current transformation session
        '''</summary>
        Public Overridable Property Session() As Global.System.Collections.Generic.IDictionary(Of String, Object)
            Get
                Return Me.sessionField
            End Get
            Set
                Me.sessionField = value
            End Set
        End Property
        #End Region
        #Region "Transform-time helpers"
        '''<summary>
        '''Write text directly into the generated output
        '''</summary>
        Public Overloads Sub Write(ByVal textToAppend As String)
            If String.IsNullOrEmpty(textToAppend) Then
                Return
            End If
            'If we're starting off, or if the previous text ended with a newline,
            'we have to append the current indent first.
            If ((Me.GenerationEnvironment.Length = 0)  _
                        OrElse Me.endsWithNewline) Then
                Me.GenerationEnvironment.Append(Me.currentIndentField)
                Me.endsWithNewline = false
            End If
            'Check if the current text ends with a newline
            If textToAppend.EndsWith(Global.System.Environment.NewLine, Global.System.StringComparison.CurrentCulture) Then
                Me.endsWithNewline = true
            End If
            'This is an optimization. If the current indent is "", then we don't have to do any
            'of the more complex stuff further down.
            If (Me.currentIndentField.Length = 0) Then
                Me.GenerationEnvironment.Append(textToAppend)
                Return
            End If
            'Everywhere there is a newline in the text, add an indent after it
            textToAppend = textToAppend.Replace(Global.System.Environment.NewLine, (Global.System.Environment.NewLine + Me.currentIndentField))
            'If the text ends with a newline, then we should strip off the indent added at the very end
            'because the appropriate indent will be added when the next time Write() is called
            If Me.endsWithNewline Then
                Me.GenerationEnvironment.Append(textToAppend, 0, (textToAppend.Length - Me.currentIndentField.Length))
            Else
                Me.GenerationEnvironment.Append(textToAppend)
            End If
        End Sub
        '''<summary>
        '''Write text directly into the generated output
        '''</summary>
        Public Overloads Sub WriteLine(ByVal textToAppend As String)
            Me.Write(textToAppend)
            Me.GenerationEnvironment.AppendLine
            Me.endsWithNewline = true
        End Sub
        '''<summary>
        '''Write formatted text directly into the generated output
        '''</summary>
        Public Overloads Sub Write(ByVal format As String, <System.ParamArrayAttribute()> ByVal args() As Object)
            Me.Write(String.Format(Global.System.Globalization.CultureInfo.CurrentCulture, format, args))
        End Sub
        '''<summary>
        '''Write formatted text directly into the generated output
        '''</summary>
        Public Overloads Sub WriteLine(ByVal format As String, <System.ParamArrayAttribute()> ByVal args() As Object)
            Me.WriteLine(String.Format(Global.System.Globalization.CultureInfo.CurrentCulture, format, args))
        End Sub
        '''<summary>
        '''Raise an error
        '''</summary>
        Public Sub [Error](ByVal message As String)
            Dim [error] As System.CodeDom.Compiler.CompilerError = New Global.System.CodeDom.Compiler.CompilerError()
            [error].ErrorText = message
            Me.Errors.Add([error])
        End Sub
        '''<summary>
        '''Raise a warning
        '''</summary>
        Public Sub Warning(ByVal message As String)
            Dim [error] As System.CodeDom.Compiler.CompilerError = New Global.System.CodeDom.Compiler.CompilerError()
            [error].ErrorText = message
            [error].IsWarning = true
            Me.Errors.Add([error])
        End Sub
        '''<summary>
        '''Increase the indent
        '''</summary>
        Public Sub PushIndent(ByVal indent As String)
            If (indent = Nothing) Then
                Throw New Global.System.ArgumentNullException("indent")
            End If
            Me.currentIndentField = (Me.currentIndentField + indent)
            Me.indentLengths.Add(indent.Length)
        End Sub
        '''<summary>
        '''Remove the last indent that was added with PushIndent
        '''</summary>
        Public Function PopIndent() As String
            Dim returnValue As String = ""
            If (Me.indentLengths.Count > 0) Then
                Dim indentLength As Integer = Me.indentLengths((Me.indentLengths.Count - 1))
                Me.indentLengths.RemoveAt((Me.indentLengths.Count - 1))
                If (indentLength > 0) Then
                    returnValue = Me.currentIndentField.Substring((Me.currentIndentField.Length - indentLength))
                    Me.currentIndentField = Me.currentIndentField.Remove((Me.currentIndentField.Length - indentLength))
                End If
            End If
            Return returnValue
        End Function
        '''<summary>
        '''Remove any indentation
        '''</summary>
        Public Sub ClearIndent()
            Me.indentLengths.Clear
            Me.currentIndentField = ""
        End Sub
        #End Region
        #Region "ToString Helpers"
        '''<summary>
        '''Utility class to produce culture-oriented representation of an object as a string.
        '''</summary>
        Public Class ToStringInstanceHelper
            Private formatProviderField  As System.IFormatProvider = Global.System.Globalization.CultureInfo.InvariantCulture
            '''<summary>
            '''Gets or sets format provider to be used by ToStringWithCulture method.
            '''</summary>
            Public Property FormatProvider() As System.IFormatProvider
                Get
                    Return Me.formatProviderField 
                End Get
                Set
                    If (Not (value) Is Nothing) Then
                        Me.formatProviderField  = value
                    End If
                End Set
            End Property
            '''<summary>
            '''This is called from the compile/run appdomain to convert objects within an expression block to a string
            '''</summary>
            Public Function ToStringWithCulture(ByVal objectToConvert As Object) As String
                If (objectToConvert Is Nothing) Then
                    Throw New Global.System.ArgumentNullException("objectToConvert")
                End If
                Dim t As System.Type = objectToConvert.GetType
                Dim method As System.Reflection.MethodInfo = t.GetMethod("ToString", New System.Type() {GetType(System.IFormatProvider)})
                If (method Is Nothing) Then
                    Return objectToConvert.ToString
                Else
                    Return CType(method.Invoke(objectToConvert, New Object() {Me.formatProviderField }),String)
                End If
            End Function
        End Class
        Private toStringHelperField As ToStringInstanceHelper = New ToStringInstanceHelper()
        Public ReadOnly Property ToStringHelper() As ToStringInstanceHelper
            Get
                Return Me.toStringHelperField
            End Get
        End Property
        #End Region
    End Class
    #End Region
End Namespace
